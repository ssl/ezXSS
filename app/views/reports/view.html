<div class="wrapper">

    {menu}

    <section class="content {%!if isLoggedIn}no-left{%/!if}">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12">
                    <div class="view-header">
                        <div class="header-title">
                            <h3 class="m-b-xs">View report</h3>
                            {%if isLoggedIn}
                            <small>The report page allows you to manage, share, and delete your report. Also holds all
                                the information like URL, cookies, HTML DOM and more.</small>
                            {%/if}
                            {%!if isLoggedIn}
                            <small>Displays various details about the report, such as the payload, URL, cookies, HTML
                                DOM, and more, allowing to analyze and interpret the data.</small>
                            {%/!if}
                        </div>
                    </div>
                    <hr>
                </div>
            </div>

            {message}

            <div class="row">
                <div class="col-lg-12">
                    <div class="panel panel-filled">
                        <div class="panel-heading">Information</div>
                        <div class="panel-body">
                            <div>
                                <table class="table table-striped table-hover report-table">
                                    <tbody>
                                        <tr class="report-row">
                                            <td class="field-name">
                                                <strong>URL</strong>
                                            </td>
                                            <td class="field-content">
                                                <code class="url-display">{%data uri}</code>
                                            </td>
                                        </tr>
                                        <tr class="report-row">
                                            <td class="field-name">
                                                <strong>IP</strong>
                                            </td>
                                            <td class="field-content">
                                                <span class="ip-display">{%data ip}</span>
                                            </td>
                                        </tr>
                                        <tr class="report-row">
                                            <td class="field-name">
                                                <strong>Referer</strong>
                                            </td>
                                            <td class="field-content">
                                                <code class="referer-display">{%data referer}</code>
                                            </td>
                                        </tr>
                                        <tr class="report-row highlight-row">
                                            <td class="field-name">
                                                <strong>Payload</strong>
                                            </td>
                                            <td class="field-content">
                                                <span class="badge badge-danger payload-badge">{%data payload}</span>
                                            </td>
                                        </tr>
                                        <tr class="report-row">
                                            <td class="field-name">
                                                <strong>Browser</strong>
                                            </td>
                                            <td class="field-content">
                                                <span class="browser-display">{%data browser}</span>
                                            </td>
                                        </tr>
                                        <tr class="report-row">
                                            <td class="field-name">
                                                <strong>User Agent</strong>
                                            </td>
                                            <td class="field-content">
                                                <small class="user-agent-display">{%data user-agent}</small>
                                            </td>
                                        </tr>
                                        <tr class="report-row expandable-row">
                                            <td class="field-name">
                                                <strong>Cookies</strong>
                                            </td>
                                            <td class="field-content">
                                                <div class="data-container">
                                                    <textarea spellcheck="false" class="form-control modern-textarea" 
                                                              rows="4" id="cookies" readonly>{%data cookies}</textarea>
                                                    <button class="btn btn-sm btn-outline-secondary copy-btn" data-target="#cookies">
                                                        Copy
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr class="report-row expandable-row">
                                            <td class="field-name">
                                                <strong>Local Storage</strong>
                                            </td>
                                            <td class="field-content">
                                                <div class="data-container">
                                                    <textarea spellcheck="false" class="form-control modern-textarea" 
                                                              rows="4" id="localstorage" readonly>{%data localstorage}</textarea>
                                                    <button class="btn btn-sm btn-outline-secondary copy-btn" data-target="#localstorage">
                                                        Copy
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr class="report-row expandable-row">
                                            <td class="field-name">
                                                <strong>Session Storage</strong>
                                            </td>
                                            <td class="field-content">
                                                <div class="data-container">
                                                    <textarea spellcheck="false" class="form-control modern-textarea" 
                                                              rows="4" id="sessionstorage" readonly>{%data sessionstorage}</textarea>
                                                    <button class="btn btn-sm btn-outline-secondary copy-btn" data-target="#sessionstorage">
                                                        Copy
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr class="report-row expandable-row">
                                            <td class="field-name">
                                                <strong>DOM</strong>
                                            </td>
                                            <td class="field-content">
                                                {%if domTooLarge}
                                                <div class="data-container">
                                                    <div class="alert alert-info">
                                                        <strong>DOM content is too large to display safely.</strong>
                                                        <br>
                                                        <small>Use the download button below to save it as a file.</small>
                                                    </div>
                                                    <a href="/manage/reports/downloaddom/{%data reportId}" class="btn btn-primary">
                                                        <i class="fa fa-download"></i> Download DOM Content
                                                    </a>
                                                </div>
                                                {%/if}
                                                {%!if domTooLarge}
                                                <div class="data-container">
                                                    <textarea spellcheck="false" class="form-control modern-textarea dom-textarea" 
                                                              rows="12" id="dom" readonly>{%data dom}</textarea>
                                                    <button class="btn btn-sm btn-outline-secondary copy-btn" data-target="#dom">
                                                        Copy
                                                    </button>
                                                </div>
                                                {%/!if}
                                            </td>
                                        </tr>
                                        <tr class="report-row">
                                            <td class="field-name">
                                                <strong>Origin</strong>
                                            </td>
                                            <td class="field-content">
                                                <code class="origin-display">{%data origin}</code>
                                            </td>
                                        </tr>
                                        
                                        {%if isJsonExtra}
                                            {%foreach extraItems}
                                            <tr class="report-row custom-field-row">
                                                <td class="field-name" title="Custom field">
                                                    <strong>{extraItems->key}</strong>
                                                    <span class="custom-field-indicator">
                                                        <small class="badge badge-secondary">Custom</small>
                                                    </span>
                                                </td>
                                                <td class="field-content" title="Custom field value">
                                                    <span class="custom-field-value">{extraItems->value}</span>
                                                </td>
                                            </tr>
                                            {%/foreach}
                                        {%/if}

                                        {%if isExtra}
                                        <tr class="report-row">
                                            <td class="field-name">
                                                <strong>Extra</strong>
                                            </td>
                                            <td class="field-content">
                                                <span class="extra-data">{%data extra}</span>
                                            </td>
                                        </tr>
                                        {%/if}

                                        <tr class="report-row timestamp-row">
                                            <td class="field-name">
                                                <strong>Time</strong>
                                            </td>
                                            <td class="field-content">
                                                <span class="timestamp-display">
                                                    <time class="time-formatted">{%data time}</time>
                                                </span>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>

                                {%if isLoggedIn}
                                <hr class="list">
                                <button class="btn delete" report-id="{%data id}">Delete</button>
                                <button class="btn archive" report-id="{%data id}">Archive</button>
                                <button class="btn share" data-target="#shareModal" data-toggle="modal"
                                    report-id="{%data id}" share-id="{%data shareid}">Share
                                </button>
                                <button class="btn copycookies" report-origin="{%data origin}">Copy cookies as
                                    JSON
                                </button>
                                <button class="btn render" report-origin="{%data origin}">Render HTML DOM</button>
                                {%/if}
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            {%if hasScreenshot}
            <div class="row">
                <div class="col-lg-12">
                    <div class="panel panel-filled">
                        <div class="panel-heading">Screenshot</div>
                        <div class="panel-body">
                            {%data screenshot}
                        </div>
                    </div>
                </div>
            </div>
            {%/if}

        </div>
    </section>
</div>

{%if isLoggedIn}
<div class="modal fade" id="shareModal" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button class="close" data-dismiss="modal" type="button">&times;</button>
                <h3 class="m-b-xs">Share</h3>
                <small>Share your reports using a direct link anyone without permissions can view</small>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="control-label" for="shareid">Direct share link</label>
                    <input class="form-control" id="shareid" type="text" value="">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" type="button">Close</button>
            </div>
        </div>
    </div>
</div>
{%/if}